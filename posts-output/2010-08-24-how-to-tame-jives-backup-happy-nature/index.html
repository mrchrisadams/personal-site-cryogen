<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Chris Adams Blog: How to tame Jive&#39;s backup happy nature</title>
        
<meta name="keywords" content="">

<meta name="description" content="I&#39;ve been looking after a Jive box at work, and the other day, the site it provided went down round about the same we were moving offices (do sites ever go down at convenient times?).   After checking the logs, it turned out that the culprit was Jive&#39;s sometimes handy, but greedy habit of creating a full dump of all the data, files added to a site every day, for the last 30 days.">

<meta property="og:description" content="I&#39;ve been looking after a Jive box at work, and the other day, the site it provided went down round about the same we were moving offices (do sites ever go down at convenient times?).   After checking the logs, it turned out that the culprit was Jive&#39;s sometimes handy, but greedy habit of creating a full dump of all the data, files added to a site every day, for the last 30 days.">

<meta property="og:url" content="http://blog.chrisadams.me.uk/posts-output/2010-08-24-how-to-tame-jives-backup-happy-nature/" />
<meta property="og:title" content="How to tame Jive&#39;s backup happy nature" />
<meta property="og:type" content="article" />

        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Oxygen:300,400,700|Inconsolata" rel="stylesheet">
        <link href="/css/normalize.css" rel="stylesheet" type="text/css" />
        <link href="/css/blog.css" rel="stylesheet" type="text/css" />
        <link href="/css/lotus-highlightjs.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <aside id="sidebar">
            <div id="logo">
                <a title="Chris Adams Blog" href="/">
                <div class="text desktop-and-tablet-only">Chris Adams Blog</div>
                <div class="text mobile-only">Chris Adams Blog</div>
                </a>
            </div>

            <nav id="sidebar-links">
                <nav id="menucont">
                    <input type="checkbox" id="menu-checkbox" class="menu-checkbox">
                    <label for="menu-checkbox" class="menutitle">
                        <svg class="icon icon-menu" aria-hidden="true"><use xlink:href="/img/icons.svg#icon-menu"></use></svg><span class="menu-text">Menu</span>
                    </label>
                    <ul class="menu">
                        <li ><a title="Home" href="/"><div class="menu-item-text">Home</div></a></li>
                        <li ><a title="Archives" href="/archives/"><div class="menu-item-text">Archives</div></a></li>
                        
                        
                        <li >
                            <a href="/pages-output/about/"><div class="menu-item-text">About</div></a>
                        </li>
                        
                        <!-- <li><a title="RSS" href="/feed.xml"><div class="menu-item-text">RSS</div></a></li> -->
                    </ul>
                </nav>

                <nav id="socialmedia">
                    <ul>
                        <li><a title="LinkedIn" href="https://www.linkedin.com/in/matthewdavidson1" rel="external"><svg class="icon icon-linkedin"><use xlink:href="/img/icons.svg#icon-linkedin"></use></svg></a></li>
                        <li><a title="GitHub" href="https://github.com/KingMob" rel="external"><svg class="icon icon-github-circled"><use xlink:href="/img/icons.svg#icon-github-circled"></use></svg></a></li>
                        <li><a title="RSS Feed" href="/feed.xml"><svg class="icon icon-rss-squared"><use xlink:href="/img/icons.svg#icon-rss-squared"></use></svg></a></li>
                    </ul>
                </nav>
            </nav>
        </aside>

        <article id="main">
            
<div id="post">
    <div class="post-header">
    <div id="post-meta">
        <h1>How to tame Jive&#39;s backup happy nature</h1>
        <div class="byline">
            <span class="date">August 24, 2010</span>
            
            <span class="author">By: admin</span>
            
        </div>
    </div>
</div>
<div>
    
    <!-- content below --><p>I've been looking after a Jive box at work, and the other day, the site it provided went down round about the same we were moving offices (do sites ever go down at convenient times?).   After checking the logs, it turned out that the culprit was Jive's sometimes handy, but greedy habit of creating a full dump of all the data, files added to a site every day, for the last 30 days.</p><p>When you're working with large uploads of Photoshop mockups this quickly burns through drive space, so I had to add a cronjob here to sweep away the older backups. There's a thread on Jive' forum's asking the same issue, so I thought I'd document it here:</p><p>First, open up your crontab as a user with the correct privileges:</p><pre lang="bash">
  crontab -e
</pre><p>then add a line like this:</p><pre lang="bash" line="1">
  # find all db dumps older than 7 days, and delete them
  # at minute 02, on hour 04, every day, every month, every year
  02 04 * * * find /usr/local/jive/var/data/backup/postgres/full -mtime +7 -exec rm -f {} \;
</pre><p>I've annotated the cron syntax <a href="http://cronwtf.github.com/" title="CronWTF!">cronwtf</a> to help make it more readable, but the second snippet requires some explanation. This line here:</p><pre lang="bash">
  find /usr/local/jive/var/data/backup/postgres/full -mtime +7 -exec rm -f {} \;  
</pre><p>Roughly translates as:</p><blockquote><p>run a 'find' all files older than 7 days, and execute a command to delete (rm -f) each file in the collection</p></blockquote><p>This creates our 'sweeper' script that clears away database dump files that would otherwise bring down the machine, leading you to lose face, and ultimately your place in society.</p><p><em>Note -<code>mtime</code> refers to the last modified time of a file. You can also think of this as the creation time of the file, as Unix does not distinguish between creation and modification. There's more here in the <a href="http://www.grymoire.com/Unix/Find.html#toc-uh-8" title="Find command manpages">manpages</a></em></p>
</div>

<br/>


    
    <div id="prev-next">
    
    <a class="prev" href="/posts-output/2010-09-12-how-i-am-debugging-drupal-views/"><svg class="icon icon-circle-left"><use xlink:href="/img/icons.svg#icon-circle-left"></use></svg><div class="nav-text">How I am debugging Drupal Views </div></a>
    
    
    <a class="next" href="/posts-output/2010-08-14-no-need-to-type-your-password-with-apache/"><div class="nav-text"">There&#39;s no need to type your password when you restart Apache, really...</div><svg class="icon icon-circle-right"><use xlink:href="/img/icons.svg#icon-circle-right"></use></svg></a>
    
</div>

    

</div>

            <hr/>
            <div id="footercont">
                Copyright &copy; 2020 Chris Adams
                <br>Powered by <a href="http://cryogenweb.org">Cryogen</a>
                <br>Theme by <a href="http://github.com/KingMob">KingMob</a>
            </div>
        </article>

        <script src="/js/highlight.pack.js" type="text/javascript"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        
        
    </body>
</html>
