<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Chris Adams Blog: Frustrating and Cryptic Ruby Idioms (#1 of a series)</title>
        
<meta name="keywords" content="">

<meta name="description" content="I keep coming across these FACRI&#39;s (Frustrating and Cryptic Ruby Idioms) in my work, so I&#39;m jotting them here in the hope that I&#39;ll remember them better in future.">

<meta property="og:description" content="I keep coming across these FACRI&#39;s (Frustrating and Cryptic Ruby Idioms) in my work, so I&#39;m jotting them here in the hope that I&#39;ll remember them better in future.">

<meta property="og:url" content="http://blog.chrisadams.me.uk/posts-output/2009-05-03-frustrating-and-cryptic-ruby-idioms-1-of-a-series/" />
<meta property="og:title" content="Frustrating and Cryptic Ruby Idioms (#1 of a series)" />
<meta property="og:type" content="article" />

        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Oxygen:300,400,700|Inconsolata" rel="stylesheet">
        <link href="/css/normalize.css" rel="stylesheet" type="text/css" />
        <link href="/css/blog.css" rel="stylesheet" type="text/css" />
        <link href="/css/lotus-highlightjs.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <aside id="sidebar">
            <div id="logo">
                <a title="Chris Adams Blog" href="/">
                <div class="text desktop-and-tablet-only">Chris Adams Blog</div>
                <div class="text mobile-only">Chris Adams Blog</div>
                </a>
            </div>

            <nav id="sidebar-links">
                <nav id="menucont">
                    <input type="checkbox" id="menu-checkbox" class="menu-checkbox">
                    <label for="menu-checkbox" class="menutitle">
                        <svg class="icon icon-menu" aria-hidden="true"><use xlink:href="/img/icons.svg#icon-menu"></use></svg><span class="menu-text">Menu</span>
                    </label>
                    <ul class="menu">
                        <li ><a title="Home" href="/"><div class="menu-item-text">Home</div></a></li>
                        <li ><a title="Archives" href="/archives/"><div class="menu-item-text">Archives</div></a></li>
                        
                        
                        <li >
                            <a href="/pages-output/about/"><div class="menu-item-text">About</div></a>
                        </li>
                        
                        <!-- <li><a title="RSS" href="/feed.xml"><div class="menu-item-text">RSS</div></a></li> -->
                    </ul>
                </nav>

                <nav id="socialmedia">
                    <ul>
                        <li><a title="LinkedIn" href="https://www.linkedin.com/in/matthewdavidson1" rel="external"><svg class="icon icon-linkedin"><use xlink:href="/img/icons.svg#icon-linkedin"></use></svg></a></li>
                        <li><a title="GitHub" href="https://github.com/KingMob" rel="external"><svg class="icon icon-github-circled"><use xlink:href="/img/icons.svg#icon-github-circled"></use></svg></a></li>
                        <li><a title="RSS Feed" href="/feed.xml"><svg class="icon icon-rss-squared"><use xlink:href="/img/icons.svg#icon-rss-squared"></use></svg></a></li>
                    </ul>
                </nav>
            </nav>
        </aside>

        <article id="main">
            
<div id="post">
    <div class="post-header">
    <div id="post-meta">
        <h1>Frustrating and Cryptic Ruby Idioms (#1 of a series)</h1>
        <div class="byline">
            <span class="date">May 3, 2009</span>
            
            <span class="author">By: admin</span>
            
        </div>
    </div>
</div>
<div>
    
    <!-- content below --><p>I keep coming across these FACRI's (Frustrating and Cryptic Ruby Idioms) in my work, so I'm jotting them here in the hope that I'll remember them better in future.</p><h4 id="ruby-idioms">Ruby idioms</h4><p>Ruby is a wonderful, if somewhat slow and memory hungry language, with an incredibly flexible and expressive syntax. However this flexibility leads to the creation of idioms that initially look totally opaque, if you don't know what to look for.</p><h5 id="case-in-point-the-objectmethod-idiom">Case in point: the object{:&amp;method} idiom</h5><p>If you want to take an array called names , want to create a new array by running a text manipulation on every member of that array, a terse, but readable way to do this would be:</p><p>result = names.map { |name| name.upcase }</p><p>The intent is pretty clear here, and what happens programatically is also very readable. Another way to do this though is write it like:</p><p>result = names.map {&amp;:upcase}</p><p>Something called type coercion is occurring here; you normally pass the <code>map</code> method a <code>Proc</code> object to execute, with a placeholder name for each iteration, and the code to run and return. However because you're not passing a Proc object here, Ruby tries to convert it on the fly into a Proc object using a method called <code>to_proc</code>:</p><p>def to_proc
proc { |obj, *args| obj.send(self, *args) }
end</p><p>So in this case, it's passing in <code>names</code>, and the method in the <code>*args</code> is <code>upcase</code>. I wasn't familiar with the <code>send</code> method here either, so the <a href="http://www.ruby-doc.org/core/classes/Object.html#M000335" title="Class: Object.send">documentation for it from ruby core</a> may help here:</p><p>class Klass
def hello(*args)
"Hello " + args.join(' ')
end
end
k = Klass.new
k.send :hello, "gentle", "readers" #=&gt; "Hello gentle readers"</p><h5 id="an-expensive-idiom-by-rockstars-for-rockstars">An expensive idiom, by rockstars, for rockstars.</h5><p>Th end result of all these examples is a saving of about 12 characters, at the expense of readability, and a huge performance hit as each member in names of passed around and type coerced like there's no tomorrow.</p><p>If you're a coding savant, the elegance of this will probably make you weep tears of syntactic joy, and the clever brevity of this isn't lost on me.</p><p>However, coming to this, without too much knowledge of the Ruby extensions project, or <a href="http://pragdave.pragprog.com/pragdave/2005/11/symbolto_proc.html" title="PragDave: Symbol#to_proc">someone to talk you through what's happening</a> is likely to be a frustrating experience.</p><p>Hope fully this will save time for someone else in future.</p>
</div>

<br/>


    
    <div id="prev-next">
    
    <a class="prev" href="/posts-output/2009-06-20-on-the-new-star-trek-movie/"><svg class="icon icon-circle-left"><use xlink:href="/img/icons.svg#icon-circle-left"></use></svg><div class="nav-text">On the new Star Trek movie</div></a>
    
    
    <a class="next" href="/posts-output/2009-04-28-how-to-set-up-a-debugger-with-mod_railspassenger/"><div class="nav-text"">How to set up a debugger with mod_rails/Passenger</div><svg class="icon icon-circle-right"><use xlink:href="/img/icons.svg#icon-circle-right"></use></svg></a>
    
</div>

    

</div>

            <hr/>
            <div id="footercont">
                Copyright &copy; 2020 Chris Adams
                <br>Powered by <a href="http://cryogenweb.org">Cryogen</a>
                <br>Theme by <a href="http://github.com/KingMob">KingMob</a>
            </div>
        </article>

        <script src="/js/highlight.pack.js" type="text/javascript"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        
        
    </body>
</html>
