<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Chris Adams Blog: There&#39;s no need to type your password when you restart Apache, really...</title>
        
<meta name="keywords" content="">

<meta name="description" content="When you&#39;re developing with PHP on a mac, if you&#39;re not using MAMP, you&#39;ll often end up having to do a lot of manual restarts when you make changes to how you&#39;ve set up Apache (assuming you haven&#39;t joined all the cool kids and moved onto Nginx yet...). This usually involves calling up a terminal window and typing in the usual Apache restart command on OS X:">

<meta property="og:description" content="When you&#39;re developing with PHP on a mac, if you&#39;re not using MAMP, you&#39;ll often end up having to do a lot of manual restarts when you make changes to how you&#39;ve set up Apache (assuming you haven&#39;t joined all the cool kids and moved onto Nginx yet...). This usually involves calling up a terminal window and typing in the usual Apache restart command on OS X:">

<meta property="og:url" content="http://blog.chrisadams.me.uk/posts-output/2010-08-14-no-need-to-type-your-password-with-apache/" />
<meta property="og:title" content="There&#39;s no need to type your password when you restart Apache, really..." />
<meta property="og:type" content="article" />

        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Oxygen:300,400,700|Inconsolata" rel="stylesheet">
        <link href="/css/normalize.css" rel="stylesheet" type="text/css" />
        <link href="/css/blog.css" rel="stylesheet" type="text/css" />
        <link href="/css/lotus-highlightjs.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <aside id="sidebar">
            <div id="logo">
                <a title="Chris Adams Blog" href="/">
                <div class="text desktop-and-tablet-only">Chris Adams Blog</div>
                <div class="text mobile-only">Chris Adams Blog</div>
                </a>
            </div>

            <nav id="sidebar-links">
                <nav id="menucont">
                    <input type="checkbox" id="menu-checkbox" class="menu-checkbox">
                    <label for="menu-checkbox" class="menutitle">
                        <svg class="icon icon-menu" aria-hidden="true"><use xlink:href="/img/icons.svg#icon-menu"></use></svg><span class="menu-text">Menu</span>
                    </label>
                    <ul class="menu">
                        <li ><a title="Home" href="/"><div class="menu-item-text">Home</div></a></li>
                        <li ><a title="Archives" href="/archives/"><div class="menu-item-text">Archives</div></a></li>
                        
                        
                        <li >
                            <a href="/pages-output/about/"><div class="menu-item-text">About</div></a>
                        </li>
                        
                        <!-- <li><a title="RSS" href="/feed.xml"><div class="menu-item-text">RSS</div></a></li> -->
                    </ul>
                </nav>

                <nav id="socialmedia">
                    <ul>
                        <li><a title="LinkedIn" href="https://www.linkedin.com/in/matthewdavidson1" rel="external"><svg class="icon icon-linkedin"><use xlink:href="/img/icons.svg#icon-linkedin"></use></svg></a></li>
                        <li><a title="GitHub" href="https://github.com/KingMob" rel="external"><svg class="icon icon-github-circled"><use xlink:href="/img/icons.svg#icon-github-circled"></use></svg></a></li>
                        <li><a title="RSS Feed" href="/feed.xml"><svg class="icon icon-rss-squared"><use xlink:href="/img/icons.svg#icon-rss-squared"></use></svg></a></li>
                    </ul>
                </nav>
            </nav>
        </aside>

        <article id="main">
            
<div id="post">
    <div class="post-header">
    <div id="post-meta">
        <h1>There&#39;s no need to type your password when you restart Apache, really...</h1>
        <div class="byline">
            <span class="date">August 14, 2010</span>
            
            <span class="author">By: admin</span>
            
        </div>
    </div>
</div>
<div>
    
    <!-- content below --><p>When you're developing with PHP on a mac, if you're not using MAMP, you'll often end up having to do a lot of manual restarts when you make changes to how you've set up Apache (assuming you haven't joined all the cool kids and moved onto Nginx yet...). This usually involves calling up a terminal window and typing in the usual Apache restart command on OS X:</p><pre lang="bash">
  sudo apachectl restart
</pre><p>This isn't a really destructive command, and having to type in your admin password every time when doing this in development on your own computer gets old quickly. It's also error prone. Surely there's a better way?</p><p>Fortunately, when browsing the <a href="http://geoffhankerson.com/node/109">Aegir OS X install documentation</a>, I came across as handy fix to this problem. The Aegir hackers let Aegir handle server restarts in a fairly elegant fashion, by tweaking the <code>sudoers</code> file on your mac, which is basically a short list of who is allowed to do what on your machine. I've borrowed a few tricks, and adaprted them to use in my sudoers file here, and after showing it in full, I'll explain how it works.</p><p>Bear in mind, you can't edit the <code>sudoers</code> file directly - you need to use the <code>visudo</code> command, (this works as a precaution to stop this file getting screwed up by letting more than one person is edit it at a time for example).</p><p>Also, to make things more complex, you need to edit this inside the terminal, to you may need to force this by typing <code>EDITOR='vim'</code> first</p><p>Okay, now that's out the way, lets look at that file:</p><pre lang="ssh" line="1">
  # Run as alias specification

  # User privilege specification
  root    ALL=(ALL) ALL
  %admin  ALL=(ALL) ALL

  # Uncomment to allow people in group wheel to run all commands
  # %wheel        ALL=(ALL) ALL

  # Same thing without a password
  # %wheel        ALL=(ALL) NOPASSWD: ALL
  %staff          ALL=(ALL) NOPASSWD: /usr/sbin/apachectl
  # Samples
  # %users  ALL=/sbin/mount /cdrom,/sbin/umount /cdrom
  # %users  localhost=/sbin/shutdown -h now
  
</pre><p>Lets look at the first lines, with <code>root</code> and <code>%wheel</code>. If you're even bothering to read this, the chances are you know that <code>root</code> refers to the all powerful user that can do anything on a system, but you may not be familiar with the percent prefix on <code>%admin</code> nor the <code>ALL=(ALL) ALL</code>. The <code>%admin</code> basically means 'anyone in the admin group, but the <code>ALL=(ALL) ALL</code> is somewhat more cryptic. The rough translation goes like this though:</p><blockquote><p>from <em>ALL</em> terminals, let these users run <em>ALL</em> commands and as <em>ALL</em> of the users in the system.</p></blockquote><p>We see the same trick visible again with the <code>%wheel</code> group, but the line starting with <code>%staff</code> deserves more attention:</p><pre lang="ssh">
  %staff          ALL=(ALL) NOPASSWD: /usr/sbin/apachectl
</pre><p>Translated, this means:</p><blockquote><p>for ALL members in the <em>staff group</em>, let them use ALL terminals, to run the command <code>/usr/sbin/apachectl</code> as ALL users (in particular, the root user) without needing a password (that's the NOPASSWD: bit).</p></blockquote><p>This is the line that lets us run the familiar <code>sudo apachectl restart</code> without needing to constantly type our password credentials in.</p><p>Which over the course of a year, will easily save you tons of typing over the year, and leave some time to skim the <a href="http://www.gratisoft.us/sudo/sudoers.man.html"><code>sudoers</code> man page</a>, and suggest a similar trick here for others to try.</p><p>Over to you now...</p>
</div>

<br/>


    
    <div id="prev-next">
    
    <a class="prev" href="/posts-output/2010-08-24-how-to-tame-jives-backup-happy-nature/"><svg class="icon icon-circle-left"><use xlink:href="/img/icons.svg#icon-circle-left"></use></svg><div class="nav-text">How to tame Jive&#39;s backup happy nature</div></a>
    
    
    <a class="next" href="/posts-output/2010-08-10-how-to-get-back-into-drupal-site-if-youve-locked-yourself-out/"><div class="nav-text"">How to get back into Drupal site if you&#39;ve locked yourself out</div><svg class="icon icon-circle-right"><use xlink:href="/img/icons.svg#icon-circle-right"></use></svg></a>
    
</div>

    

</div>

            <hr/>
            <div id="footercont">
                Copyright &copy; 2020 Chris Adams
                <br>Powered by <a href="http://cryogenweb.org">Cryogen</a>
                <br>Theme by <a href="http://github.com/KingMob">KingMob</a>
            </div>
        </article>

        <script src="/js/highlight.pack.js" type="text/javascript"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        
        
    </body>
</html>
